wf-test-polars-tasks:
  type: Workflow
  params:
    source:
      desc: "A source path of local data source."
      type: str
    target:
      desc: "A target path of local data source."
      type: str
  jobs:
    csv-job:
      stages:

        - name: "Count CSV"
          id: count-csv
          uses: tasks/count-csv@polars
          with:
            source: ${{ params.source }}

        - name: "Count CSV with Condition"
          id: count-condition-csv
          uses: tasks/count-csv@polars
          with:
            source: ${{ params.source }}
            condition: "`First Name` == 'Roy'"

        - name: "Load CSV to Parquet"
          id: load-csv-to-parquet
          echo: "Start Load CSV to Parquet stage."

    xlsx-job:
      stages:

        - name: "Count XLSX"
          id: count-xlsx
          uses: tasks/count-xlsx@polars
          with:
            source: ${{ params.source }}
