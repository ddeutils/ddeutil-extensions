wf-test-polars-tasks:
  type: Workflow
  params:
    source:
      desc: "A source path of local data source."
      type: str
    sink:
      desc: "A sink path of local data source."
      type: str
  jobs:
    csv-job:
      stages:

        - name: "Count CSV"
          id: count-csv
          uses: tasks/count-csv@polars
          with:
            source: ${{ params.source }}

        - name: "Count CSV with Condition"
          id: count-condition-csv
          uses: tasks/count-csv@polars
          with:
            source: ${{ params.source }}
            condition: "`First Name` == 'Roy'"

        - name: "Convert CSV to Parquet"
          id: convert-csv-to-parquet
          uses: tasks/convert-csv-to-parquet@polars
          with:
            source: ${{ params.source }}
            sink: ${{ params.sink }}

    excel-job:
      stages:

        - name: "Count excel"
          id: count-excel
          uses: tasks/count-excel@polars
          with:
            source: ${{ params.source }}

        - name: "Convert Excel to Parquet"
          id: convert-excel-to-parquet
          uses: tasks/convert-excel-to-parquet@polars
          with:
            source: ${{ params.source }}
            sink: ${{ params.sink }}
